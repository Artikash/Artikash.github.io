<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Artikash's Blog</title>
	<style>
		body {
			background: #eeeeee;
			line-height: 1.6;
			font-size: 18px;
			color: #444;
			margin: 30px 0;
			padding: 0;
		}

		h1,
		h2,
		h3 {
			line-height: 1.2;
		}

		header {
			text-align: center;
			border-bottom: 3px solid black;
		}

		#main {
			display: flex;
			max-width: 1000px;
			margin: 10px auto;
		}

		@media (max-width: 600px) {
			#main {
				flex-direction: column;
			}
		}

		#blog {
			max-width: 600px;
			padding: 0 50px;
		}

		#archive {
			max-width: 200px;
			padding: 0 50px;
		}
	</style>
</head>

<body>
	<header>
		<h1>Welcome to <a href="https://github.com/Artikash">Artikash</a>'s blog.</h1>
		<p>Where I discuss code and whatever else I feel like.<br><a href="/">Home</a></p>
		<h2></h2>
	</header>
	<div id="main">
		<div id="blog">
			<h2>Loading...</h2>
		</div>
		<div id="archive">
			<h2>Archive</h2>
		</div>
	</div>
	<script>
		var posts = [
			{
				month: "March 2019",
				links: [
					"<a href=\"?clipboard_monitor\">Clipboard Monitor</a>",
					"<a href=\"?iile\">Immediately Invoked Lambda Expressions in C++</a>"
				]
			},
			{
				month: "February 2019",
				links: [			
					"<a href=\"?hello_world\">Hello World!</a>"
				]
			}
		];

		var archive = document.getElementById("archive");
		for (var i = 0; i < posts.length; ++i) {
			var element = archive.appendChild(document.createElement("h3"));
			element.innerText = posts[i].month;
			(function (element, links) {
				element.style.cursor = "pointer";
				var list = null;
				element.onclick = function () {
					if (list) {
						archive.removeChild(list);
						list = null;
					} else {
						list = document.createElement("ul");
						for (var i = 0; i < links.length; ++i) {
							list.appendChild(document.createElement("li")).innerHTML = links[i];
						}
						element.insertAdjacentElement("afterend", list);
					}
				};
			})(element, posts[i].links);
		}

		var defaultContent = "<h2>Your browser is incompatible with this webpage :(</h2>";
		var xhr = new XMLHttpRequest();
		xhr.open("GET", (window.location.search || "doesnt_exist").slice(1));
		xhr.send();
		xhr.onreadystatechange = function () {
			if (xhr.status === 4) {
				document.getElementById("blog").innerHTML = xhr.responseText.slice(0, 15) === "<!DOCTYPE html>"
					? defaultContent
					: xhr.responseText;
			}
		};

		defaultContent = "<h2>Recent Posts</h2>";
		var recentPostCount = 0;
		for (var i = 0; i < posts.length && recentPostCount < 10; ++i) {
			for (var j = 0; j < posts[i].links.length && recentPostCount < 10; ++j) {
				defaultContent += "<h3>" + posts[i].links[j] + "</h3>";
				recentPostCount += 1;
			}
		}
	</script>
</body>

</html>